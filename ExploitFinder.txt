local Players = game:GetService("Players")
local MarketService = game:GetService("MarketplaceService")
local tweenservice = game:GetService("TweenService")
local Client = Players.LocalPlayer

local PlayerGui = Client.PlayerGui

local function setupframe()
	
	local newGUI = Instance.new("ScreenGui")
	newGUI.Parent = PlayerGui
	newGUI.DisplayOrder = 1000000
	
	local mainFrame = Instance.new("Frame")
	mainFrame.Parent = newGUI
	mainFrame.BackgroundColor3 = Color3.fromRGB(62, 62, 62)
	mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
	mainFrame.Size = UDim2.new(0.35, 0, 0.3, 0)
	mainFrame.Position = UDim2.new(0.5, 0, 0, 0)
	
	local Ratio = Instance.new("UIAspectRatioConstraint")
	Ratio.Parent= mainFrame
	Ratio.AspectRatio = 1.4
	Ratio.AspectType = Enum.AspectType.FitWithinMaxSize
	Ratio.DominantAxis = Enum.DominantAxis.Width
	
	local credits = Instance.new("TextLabel")
	credits.Parent = mainFrame
	credits.AnchorPoint = Vector2.new(0.5, 0.5)
	credits.BackgroundTransparency = 1
	credits.Size = UDim2.new(0.9, 0, 0.27, 0)
	credits.Position = UDim2.new(0.5, 0, 0.5, 0)
	credits.TextColor3 = Color3.fromRGB(167, 167, 167)
	credits.TextScaled = true
	credits.Font = Enum.Font.Arimo
	credits.TextTransparency = 0.5
	credits.FontFace.Bold = true
	credits.Text = "Made by spectraX, @Missaw"
	
	local UICornerforMainFrame = Instance.new("UICorner")
	UICornerforMainFrame.Parent = mainFrame
	UICornerforMainFrame.CornerRadius = UDim.new(0, 5)
	
	local secondFrame = Instance.new("Frame")
	secondFrame.Parent = mainFrame
	secondFrame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
	secondFrame.AnchorPoint = Vector2.new(0.5, 0.5)
	secondFrame.Size = UDim2.new(0.98, 0, 0.16, 0)
	secondFrame.Position = UDim2.new(0.5, 0, 0.094, 0)
	
	local UICornerforSecondFrame = Instance.new("UICorner")
	UICornerforSecondFrame.Parent = secondFrame
	UICornerforSecondFrame.CornerRadius = UDim.new(0, 5)
	
	local title = Instance.new("TextLabel")
	title.Parent = secondFrame
	title.AnchorPoint = Vector2.new(0.5, 0.5)
	title.BackgroundTransparency = 1
	title.Size = UDim2.new(0.8, 0, 0.9, 0)
	title.Position = UDim2.new(0.5, 0, 0.5, 0)
	title.TextColor3 = Color3.fromRGB(167, 167, 167)
	title.TextScaled = true
	title.Font = Enum.Font.ArimoBold
	title.FontFace.Bold = true
	title.Text = "EXPLOIT FINDER"
	
	local button = Instance.new("TextButton")
	button.Parent = mainFrame
	button.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
	button.AnchorPoint = Vector2.new(0.5, 0.5)
	button.Size = UDim2.new(0.521, 0, 0.135, 0)
	button.Position = UDim2.new(0.5, 0, 0.9, 0)
	button.TextColor3 = Color3.fromRGB(167, 167, 167)
	button.TextScaled = true
	button.Font = Enum.Font.ArimoBold
	button.FontFace.Bold = true
	button.Text = "SCAN"
	
	local closebutton = Instance.new("TextButton")
	closebutton.Parent = secondFrame
	closebutton.BackgroundTransparency = 1
	closebutton.AnchorPoint = Vector2.new(0.5, 0.5)
	closebutton.Size = UDim2.new(0.6, 0, 0.6, 0)
	closebutton.Position = UDim2.new(0.95, 0, 0.5, 0)
	closebutton.TextColor3 = Color3.fromRGB(117, 117, 117)
	closebutton.TextScaled = true
	closebutton.Font = Enum.Font.ArimoBold
	closebutton.FontFace.Bold = true
	closebutton.Text = "X"
	
	local soundHover = Instance.new("Sound")
	soundHover.Parent = button
	soundHover.SoundId = "rbxassetid://552900451"
	
	local UICornerforbutton = Instance.new("UICorner")
	UICornerforbutton.Parent = button
	UICornerforbutton.CornerRadius = UDim.new(0, 5)
	
	tweenservice:Create(mainFrame, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Position = UDim2.new(0.5, 0, 0.5, 0)}):Play()

	task.wait(1)
	closebutton.MouseButton1Click:Connect(function()
		newGUI:Destroy()
	end)
	
	local dragging = false

	mainFrame.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)
	
	mainFrame.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
			local mouse = Client:GetMouse()
			mainFrame.Position = UDim2.new(0, mouse.X, 0, mouse.Y)
		end
	end)
	
	button.MouseEnter:Connect(function()
		soundHover:Play()
	end)
	
	button.MouseButton1Click:Connect(function()
		button:Destroy()
		credits:Destroy()
		tweenservice:Create(mainFrame, TweenInfo.new(4, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Size = UDim2.new(0.35, 0, 0.6, 0)}):Play()
		
		local list = Instance.new("ScrollingFrame")
		list.Parent = mainFrame
		list.AutomaticCanvasSize = Enum.AutomaticSize.Y
		list.BackgroundColor3 = Color3.fromRGB(42, 42, 42)
		list.AnchorPoint = Vector2.new(0.5, 0.5)
		list.Size = UDim2.new(0.95, 0, 0.73, 0)
		list.Position = UDim2.new(0.5, 0, 0.61, 0)
		
		local Uilistlayout = Instance.new("UIListLayout")
		Uilistlayout.Parent = list
		Uilistlayout.Padding = UDim.new(0.01, 0)
		Uilistlayout.FillDirection = Enum.FillDirection.Vertical
		Uilistlayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
		Uilistlayout.VerticalAlignment = Enum.VerticalAlignment.Top
		
		task.wait(1)
		
		local function addInfo(input)
			local newInfo = Instance.new("TextLabel")
			newInfo.Parent = list
			newInfo.Text = input
			newInfo.TextColor3 = Color3.fromRGB(255, 255, 255)
			newInfo.Size = UDim2.new(0.8, 0, 0.8, 0)
			newInfo.BackgroundTransparency = 1
			newInfo.TextScaled = true
		end
		
		local anyExploit = false
		local checktime = 5
		while task.wait(0.5) do
			
			if checktime <= 0 then
				break
			end
			
		for _, item in game:GetDescendants() do
			if item:IsA("RemoteEvent") or item:IsA("RemoteFunction") then
				anyExploit = true
			end
		end
		
		if not anyExploit then
			checktime -= 1
		else 
			break 
		end
		
		end
		
		if not anyExploit then
			addInfo("We're sorry ! We did not found any exploitation items in the game.")
		else
			local function getAncestorsString(item)
				local ancestors = {}
				local current = item

				while current.Parent do
					table.insert(ancestors, 1, current.Name.."("..current.ClassName..")")
					current = current.Parent
				end

				table.insert(ancestors, 1, "game")

				return table.concat(ancestors, " > ")
			end

			for _, item in ipairs(game:GetDescendants()) do
				if item:IsA("RemoteEvent") or item:IsA("RemoteFunction") then
					local ancestorsString = getAncestorsString(item)
					addInfo(ancestorsString)
				end
			end
		end
		
	end) 
end
setupframe()
